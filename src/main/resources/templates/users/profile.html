<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>User Profile</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">
</head>
<body>
<!--<nav th:include="partials/navbar.html :: nav"></nav>-->


<main>
  <!--Main Container-->

  <div class="bg-light">
    <!-- USER INFO -->
    <div class="container pt-4">
      <div class="row">
        <!-- IF CUSTOMER HAS PROFILE PICTURE -->
        <div class="col-4 col-sm-3 text-center px-lg-5 mb-4">
          <img width="100%" th:src="${user.avatar}" class="rounded-circle shadow-sm" style="border: 5px solid rgb(255, 255, 255);">
        </div>
        <div class="col-8 col-sm-9 mb-4">
          <div class="mb-2">
            <h2 class="mb-0" th:text="${user.firstName}"></h2>
          </div>
          <!-- IF CUSTOMER IS HAS ABOUT ME ELSE -->
          <p>
            <em>
              <small th:text="${user.getAboutMe()} ?: 'Introduce yourself to the community by writing a little about yourself.'"></small>
            </em>
          </p>
          <!-- EDIT PROFILE LINK -->
          <div>
            <button type="button" class="el-button el-button--default el-button--small is-plain">
              <span>Edit Profile</span>
            </button>
          </div>
        </div>
      </div>
      <!-- END USER INFO -->
      <div>
          <ul class="nav nav-tabs">
            <li class="nav-item" id="userRecipes">
              <a class="nav-link" href="#">
                  <i class="far fa-utensils fa-2x"></i>
                  <i class="fas fa-utensils fa-2x"></i>
              </a>
            </li>
            <li class="nav-item" id="userFavorites">
              <a class="nav-link" href="#">
                  <!--              <i class="far fa-bookmark fa-2x"></i>-->
                  <i class="fas fa-bookmark fa-2x"></i>
              </a>
            </li>
            <li class="nav-item" id="userPantry">
              <a class="nav-link" href="#">
                  <i class="fas fa-lemon"></i><i class="fas fa-apple-alt fa-2x"></i><i class="fas fa-carrot"></i>
              </a>
            </li>

            <li class="nav-item" id="userFollowers">
              <a class="nav-link" href="#">
                  <i class="fas fa-users fa-2x"></i>
              </a>
            </li>
            <li class="nav-item" id="userFollowing">
              <a class="nav-link" href="#">
                  <i class="fas fa-user-plus fa-2x"></i>
              </a>
            </li>
          </ul>
      </div>
    </div>
    <div id="userContent"></div>
  </div>
</main>





<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>
    <script th:inline="javascript">
      /*<![CDATA[*/
      (function($) {
        let userId = /*[[${user.id}]]*/ '';
        $( "#userPantry" ).click(function() {
          var request = $.ajax({'url': '/api/users/'+userId+"/pantry"});
          request.done(function (response) {
            let pantryIngredients = response.pantryIngredients;
              var html = '';

              pantryIngredients.forEach(function(item) {
                  html += '<div>';
                  html += '<h5>' + item.ingredient.name + '</h5>';
                  html += '<p>' + item.amount + '</p>';
                  html += '<p>' + item.unit+ '</p>';
                  html += '</div>';
              });
              $('#userContent').html(html);
          });

        });
        $( "#userRecipes" ).click(function() {
          var request = $.ajax({'url': '/api/users/'+userId+"/recipes"});
          request.done(function (response) {

            let recipes = response;
            var html = '';

            recipes.forEach(function(recipe) {
              html += '<div>';
              html += '<h5>' + recipe.title + '</h5>';
              html += '<p>' + recipe.description + '</p>';
              html += '<p>' + recipe.directions+ '</p>';
              html += '<p>' + recipe.difficulty+ '</p>';
              html += '<p>' + recipe.chef.firstName+ '</p>';
              html += '</div>';
            });
            $('#userContent').html(html);
          });
        });

        $( "#userFavorites" ).click(function() {
            var request = $.ajax({'url': '/api/users/'+userId+"/favorites"});
            request.done(function (response) {
              let favorites = response;
              var html = '';

              favorites.forEach(function(recipe) {
                html += '<div>';
                html += '<h5>' + recipe.title + '</h5>';
                html += '<p>' + recipe.description + '</p>';
                html += '<p>' + recipe.directions+ '</p>';
                html += '<p>' + recipe.difficulty+ '</p>';
                html += '<p>' + recipe.chef.firstName+ '</p>';
                html += '</div>';
              });
              $('#userContent').html(html);
            });
        });

        $( "#userFollowers" ).click(function() {
          var request = $.ajax({'url': '/api/users/'+userId+"/followers"});
          request.done(function (response) {
            let followers = response;
            var html = '';

            followers.forEach(function(follower) {
              html += '<div>';
              html += '<h5>' + follower.firstName + '</h5>';
              html += '<div>' +
                      '<a href="/users/'+ follower.id + '">'+
                      '<img src="'+ follower.avatar +'" class="rounded-circle shadow-sm" style="border: 5px solid rgb(255, 255, 255);">' +
                      '</div>'+
                      '</a>'
              html += '</div>';
            });
            $('#userContent').html(html);
          });
        });

        $( "#userFollowing" ).click(function() {
          var request = $.ajax({'url': '/api/users/'+userId+"/following"});
          request.done(function (response) {
            let following = response;
            var html = '';

            following.forEach(function(friend) {
              html += '<div>';
              html += '<h5>' + friend.firstName + '</h5>';
              html += '<div>' +
                      '<a href="/users/'+ friend.id + '">'+
                      '<img src="'+ friend.avatar +'" class="rounded-circle shadow-sm" style="border: 5px solid rgb(255, 255, 255);">' +
                      '</div>'+
                      '</a>'
              html += '</div>';
            });
            $('#userContent').html(html);
          });
        });

        // var request = $.ajax({'url': '/api/users'});
        // request.done(function (users) {
        //     var html = '';
        //     users.forEach(function(user) {
        //         html += '<div>';
        //         html += '<h1>' + user.firstName + '</h1>';
        //         html += '<p>' + user.lastName + '</p>';
        //         html += '<p>' + user.email+ '</p>';
        //         html += '</div>';
        //     });
        //     $('#users').html(html);
        // });

        // $("#createUser").submit(function(e) {
        //
        //     e.preventDefault(); // avoid to execute the actual submit of the form.
        //
        //     var form = $(this);
        //     var url = form.attr('action');
        //     var formData = JSON.stringify($(this).serializeArray());
        //     console.log(formData);
        //     $.ajax({
        //         type: "POST",
        //         url: url,
        //         data: formData,
        //         dataType: "json",
        //         contentType : "application/json"
        //     });
        //
        //
        // });

      })(jQuery);
      /*]]>*/
    </script>
</body>
</html>
